<!DOCTYPE HTML>
<!--
	Prologue by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Nattawat-R._Portfolio</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-okaidia.min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/line-numbers/prism-line-numbers.min.css" />
	</head>
	<body class="is-preload">

		<!-- Header -->
			<div id="header">

				<div class="top">

					<!-- Logo -->
					<div id="logo">							
						<h1 id="title">Nattawat Rattanalangkarn</h1>
						<p>Data Analyst | Project Management | Design Engineer</p>
					</div>

					<!-- Nav -->
						<nav id="nav">
							<ul>
								<li><a href="index.html#top" id="top-link"><span class="icon solid fa-home">Home</span></a></li>
								<li><hr class="nav-separator"></li>
								<li><a href="#Intro" id="Intro-link">Project Introduction</span></a></li>
								<li><a href="#ask" id="ask-link">Ask</span></a></li>
								<li><a href="#prepare" id="prepare-link">Prepare</span></a></li>
								<li><a href="#process" id="process-link">Process</span></a></li>
								<li><a href="#analyze" id="analyze-link">Analyze</span></a></li>
								<li><a href="#share_act" id="share_act-link">Share & Act</span></a></li>


							</ul>
						</nav>

				</div>

				<div class="bottom">

					<!-- Social Icons -->
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/nattawat-rattanalangkarn-bb087a253/" class="icon brands fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://github.com/Nattawat-R" class="icon brands fa-github"><span class="label">Github</span></a></li>
							<li><a href="mailto:n.rattanalangkarn@gmail.com" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
						</ul>

				</div>

			</div>

		<!-- Main -->
			<div id="main">
                <!-- Intro -->
					<section id="Intro" class="five dark cover">
						<div class="container">
							<header>
								<h2>Fitness Tracker Usage <br/> 
									Trends & Marketing Insight</h2>
							</header>
							<p> Practicing project by using open-source data to make a marketing campaign for 'Bellabeat'.<br/>	</p>								
							<p style="font-size: 15px;"> Bellabeat, a high-tech company that manufactures health-focused smart products. Collecting data on <br/>
								activity, sleep, stress, and reproductive health has allowed Bellabeat 
								to empower users with knowledge about their own health and habits.</p>	
							<footer>
								<a href="#share_act" class="button scrolly">Presentation</a>
							</footer>
						</div>
					</section>
				
				<!-- Ask -->
					<section id="ask" class="two">
						<div class="container">
							<header>
								<h2>Ask</h2>
							</header>
							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Target of this analysis?</strong></p>	
							<p style="text-align: left; font-size: 18px; line-height: 1.5em;margin-bottom: 2.5em;color:#435353 ;">=> Findings trends among non-Bellabeat users should be analyzed to create a marketing strategy for promoting the scalability of Bellabeat.</p>

							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Who will be stakeholders to present findings to?</strong></p>		
							<p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 2.5em; color:#435353 ;">=> The Bellabeat executive team, marketing managers, and product development teams will be presented with the findings.</p>								
						</div>
					</section>

				<!-- Prepare -->
				   <section id="prepare" class="two">
					    <div class="container">
						    <header>
							 <h2>Prepare</h2>
						    </header>
							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Data Collection</strong></p>	
							<p style="text-align: left; font-size: 18px; line-height: 1.5em;margin-bottom: 2.5em; color:#435353 ;">=> Data will be collected from non-Bellabeat fitness tracking users' activity logs, specifically focusing on their exercise intensity, Heart rate and sleep patterns.</p>

							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Data Collection Period</strong></p>		
						    <p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 2.5em; color:#435353 ;">=> A one-month data collection period (31 days) has been chosen to capture a comprehensive snapshot of user activity and behavior.</p>	

							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Data Collection Method</strong></p>		
							<p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 2.5em; color:#435353 ;">=> Data will be collected through an survey administered to non-Bellabeat users.</p>	

							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>How much data to collect</strong></p>		
							<p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 2.5em; color:#435353 ;">=> Typically, the sample size is determined by considering factors such as the desired margin of error and confidence level<br/>but 33 participants will be chosen as per provided in the data source, which aligns with the recommended minimum sample size of 30 based on the Central Limit Theorem (CLT).</p>	

							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Data Source</strong></p>		
						    <p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 0em; color:#435353 ;">=>  The data will be sourced from a third-party provider, which has an extensive user base of non-Bellabeat users. These users have voluntarily shared their data for analysis, as indicated by the provided link
							<a href="https://www.kaggle.com/datasets/arashnic/fitbit">(https://www.kaggle.com/datasets/arashnic/fitbit).</a></p>
							<p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 2.5em; color:#AA001C ;">*Please note that since the data source is not officially affiliated with any smart products brands, the analysis conducted is solely for practice and demonstration purposes.*</p>

							<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>Database Table Relationships</strong></p>		
							<p style="text-align: left; font-size: 18px; line-height: 1.5em; margin-bottom: 0em; color:#435353 ;">The below diagram shown relational database according to the provided data source.</p>	
							<div class="image-container" style="display: flex; justify-content: center;">
								<a class="image featured" style="width: 90%;">
									<img src="images/QuickDBD-Fitabase.png" alt="" />
								</a>
							</div>
							
					    </div>
				   </section>				
	<!-- Process -->
	<section id="process" class="two">
		<div class="container">
		  <header>
			<h2>Process</h2>
		  </header>
		  <p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>1. Validate data compatibility across tables:</strong></p> 
		  <p style="text-align: left; font-size: 20px;margin-bottom: 0em; color:#435353 ;"> After uploading all data tables onto BigQuery, verify data type compatibility across all tables using SQL code, such as the one shown below.</p>
<pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT
	column_name,
	table_name,
	data_type
   FROM
	`my-first-project-project-51124.Fitabase.INFORMATION_SCHEMA.COLUMNS`
   WHERE
	REGEXP_CONTAINS(LOWER(table_name),"day|daily")
	AND column_name IN (
	  SELECT
	  column_name
	  FROM
	  `my-first-project-project-51124.Fitabase.INFORMATION_SCHEMA.COLUMNS`
	  WHERE
	  REGEXP_CONTAINS(LOWER(table_name),"day|daily")
	  GROUP BY
	  1
	  HAVING
	  COUNT(table_name) >=2)
   ORDER BY
	1;
   SELECT
	A.Id,
	A.Calories,
	* EXCEPT(Id,
	  Calories,
	  ActivityDay,
	  SedentaryMinutes,
	  LightlyActiveMinutes,
	  FairlyActiveMinutes,
	  VeryActiveMinutes,
	  SedentaryActiveDistance,
	  LightActiveDistance,
	  ModeratelyActiveDistance,
	  VeryActiveDistance),
   
   FROM
	`my-first-project-project-51124.Fitabase.Daily_Activity` A
   LEFT JOIN
	`my-first-project-project-51124.Fitabase.dailyCalories_merged_transformed` B
   ON
	A.Id = B.Id
	AND A.ActivityDate=B.ActivityDay
	AND A.Calories = B.Calories
   ;
</code></pre>
</br>
<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>2. Data cleaning and transformation for compatibility to facilitate analysis across tables:</strong></p> 
<p style="text-align: left; font-size: 20px;margin-bottom: 0em; color:#435353 ;"> 2.1. Separate timestamp data into date and time formats.</p>
   <pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT 
	Id,
	PARSE_DATE('%m/%d/%Y',SUBSTR(Time,1,9)) AS ActivityDate,
	PARSE_TIME('%I:%M:%S %p', (SUBSTR(Time,10,21))) AS Activity_Time,
	Value
   FROM 
   `my-first-project-project-51124.Fitabase.Heartrate_Seconds`
   ;
</code></pre>

   <p style="text-align: left; font-size: 20px;margin-bottom: 0em; color:#435353 ;"> 2.2. Convert different date formats into a universal format.</p>
   <pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT  
	Id,
	CASE
	  WHEN REGEXP_CONTAINS(LogDate, r'\d{2}-\d{2}-\d{2}') THEN PARSE_DATE('%m-%d-%y', LogDate)
	  WHEN REGEXP_CONTAINS(LogDate, r'\d{1,2}/\d{1,2}/\d{4}') THEN PARSE_DATE('%m/%d/%Y', LogDate)
	   -- WHEN statements as per date format difference
	  END AS LogDate,
	LogTime,
	WeightKg,
	WeightPounds,
	Fat,
	BMI,
	IsmanualReport,
	LogId
	
   FROM `my-first-project-project-51124.Fitabase.Reformed_Weight_LogInfo` 
   ORDER BY Id,LogDate,LogTime
   ;
</code></pre>
</br>

<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>3. Check data integrity:</strong></p> 
<p style="text-align: left; font-size: 20px;margin-bottom: 0em; color:#435353 ;"> 3.1. Validate the availability of device functions (intensity, heart rate, and sleep) for all participants.</p>
   <pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT
	DISTINCT (a.Id) AS User_Id,
	CASE WHEN a.ActivityDate IS NOT NULL THEN "Available" ELSE "No" END AS DailyIntensity_Function,
	CASE WHEN b.ActivityDate IS NOT NULL THEN "Available" ELSE "No" END AS HeartRate_Function,
	CASE WHEN d.ActivityDate IS NOT NULL THEN "Available" ELSE "No" END AS Sleep_Function,
	CASE WHEN c.Logdate IS NOT NULL THEN "Available" ELSE "No" END AS WeightInput_Function,
   
   FROM
   `my-first-project-project-51124.Fitabase.Daily_Activity` AS a
   
   LEFT JOIN `my-first-project-project-51124.Fitabase.Heart_seconds_transformed` AS b
	ON a.Id = b.Id AND a.ActivityDate = b.ActivityDate
   LEFT JOIN `my-first-project-project-51124.Fitabase.ReformedAndTransformed_Weight_Log` AS c
	ON a.Id = c.Id AND a.ActivityDate = c.LogDate
   LEFT JOIN `my-first-project-project-51124.Fitabase.Minute_Sleep_transformed` AS d
	ON a.Id = d.Id AND a.ActivityDate = d.ActivityDate
   
   ORDER BY User_Id
   ;
</code></pre>

<p style="text-align: left; font-size: 20px;margin-bottom: 0em; color:#435353 ;"> 3.2. Verify the consistency of date records of each user across all functions.</p>
   <pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT
	DISTINCT (a.Id) AS User_Id,
	a.ActivityDate AS Activity_Date,
	b.ActivityDate AS Heart_Date,
	c.Logdate AS WeightLog_Date,
	d.ActivityDate AS Sleep_Date
   
   FROM
   `my-first-project-project-51124.Fitabase.Daily_Activity` AS a
   
   LEFT JOIN `my-first-project-project-51124.Fitabase.Heart_seconds_transformed` AS b
	ON a.Id = b.Id AND a.ActivityDate = b.ActivityDate
   LEFT JOIN `my-first-project-project-51124.Fitabase.ReformedAndTransformed_Weight_Log` AS c
	ON a.Id = c.Id AND a.ActivityDate = c.LogDate
   LEFT JOIN `my-first-project-project-51124.Fitabase.Minute_Sleep_transformed` AS d
	ON a.Id = d.Id AND a.ActivityDate = d.ActivityDate
   
   ORDER BY User_Id, Activity_Date
   ;
  
</code></pre>
		</div>
	  </section>
	
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-sql.min.js"></script>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/line-numbers/prism-line-numbers.min.js"></script>
	  <script>
		document.addEventListener('DOMContentLoaded', function() {
		  Prism.highlightAll();
		});
	  </script>

				<!-- Analyze -->
				<section id="analyze" class="two">
					<div class="container">
					   <header>
						<h2>Analyze</h2>
					   </header>
					   <p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>1. Analyze the frequency of user-worn tracker days per month. </strong></p> 
   <pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT 
	Id,
	Total_Day_Wore
   
   FROM
	(
	 SELECT 
	  Id, 
	  COUNT (ActivityDate) AS Total_Day_Wore
	 FROM
	  `my-first-project-project-51124.Fitabase.Daily_Activity`
	  GROUP BY Id
	) 
	GROUP BY Id, Total_Day_Wore
	;
   
</code></pre>
</br>
<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>2. Analyze the frequency of user-worn tracker hours per day. </strong></p> 
<pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">SELECT 
	Id,
	(Total_Minutes_Wore / Total_Day_Wore)/60 AS AVG_Hour_WorePerDay
   
   FROM
	(
	 SELECT 
	  Id, 
	  COUNT (ActivityDate) AS Total_Day_Wore,
	  SUM(VeryActiveMinutes + FairlyActiveMinutes + LightlyActiveMinutes + SedentaryMinutes) AS Total_Minutes_Wore
	 FROM
	  `my-first-project-project-51124.Fitabase.Daily_Activity`
	  GROUP BY Id
	) 
    ;   
</code></pre>
</br>
					   <p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>3. Analyze average distribution of active intensity across each period of the day in a week. </strong></p> 
   <pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">DECLARE
	MORNING_START,
	MORNING_END,
	AFTERNOON_END,
	EVENING_END INT64;
	-- Set the times for the times of the day
   SET
	MORNING_START = 6;
   SET
	MORNING_END = 12;
   SET
	AFTERNOON_END = 18;
   SET
	EVENING_END = 21;
   
   SELECT
	  DISTINCT  FORMAT_DATE("%w", ActivityDate) AS dow_number,
	  FORMAT_DATE("%A", ActivityDate) AS day_of_week,
	  CASE
		WHEN FORMAT_DATE("%A", ActivityDate) IN ("Sunday", "Saturday") THEN "Weekend"
		WHEN FORMAT_DATE("%A", ActivityDate) NOT IN ("Sunday","Saturday") THEN "Weekday"
		ELSE "ERROR" END AS part_of_week,
	  CASE
		WHEN TIME(Activity_Time) BETWEEN TIME(MORNING_START, 0, 0) AND TIME(MORNING_END, 0, 0) THEN "Morning"
		WHEN TIME(Activity_Time) BETWEEN TIME(MORNING_END, 0, 0) AND TIME(AFTERNOON_END,0, 0) THEN "Afternoon"
		WHEN TIME(Activity_Time) BETWEEN TIME(AFTERNOON_END, 0, 0) AND TIME(EVENING_END, 0, 0) THEN "Evening"
		WHEN TIME(Activity_Time) >= TIME(EVENING_END,0,0) OR TIME(TIME_TRUNC(Activity_Time, MINUTE)) <= TIME(MORNING_START,0,0) THEN "Night"
	  ELSE "ERROR" END AS time_of_day,
	  SUM(TotalIntensity) AS sum_total_intensity_TimeofDay,
	  SUM(AverageIntensity) AS sum_average_intensity_Per_TimeofDay,
	  AVG(AverageIntensity) AS avg_average_intensity_Per_TimeofDay,
	  MAX(AverageIntensity) AS max_average_intensity_Per_TimeofDay,
	  MIN(AverageIntensity) AS min_average_intensity_Per_TimeofDay
	FROM
	`my-first-project-project-51124.Fitabase.Hourly_Intensities_transformed`
	GROUP BY
	  1,
	  2,
	  3,
	  4
	ORDER BY 1,2,3,4 
	;
</code></pre>
</br>
<p style="text-align: left; font-size: 26px;margin-bottom: 0em; "><strong>4. Analyze heart rate track consistency percentage when wearing compared to intensity trackability (assuming intensity tracking is constant when worn).</strong></p> 
<pre class="code-container" style="font-size: 14px; "><code class="language-sql line-numbers">WITH  Daily_Minute_WornPerDay AS
	( 
	  SELECT 
	   Id, 
	   ActivityDate,
	   SUM(VeryActiveMinutes + FairlyActiveMinutes + LightlyActiveMinutes + SedentaryMinutes) AS Total_Minutes_Worn,
	  FROM
	   `my-first-project-project-51124.Fitabase.Daily_Activity`
	   GROUP BY Id, ActivityDate
	)
	
	SELECT
	 User_ID,
	 SUM(Track_Percent_PerDay) / COUNT (Activity_Date) AS Track_Consistency_Percent_PerID
	FROM 
	 (
	   SELECT 
		 User_ID,
		 Activity_Date,
		 (Heart_Record_Minutes/Total_Minutes_Worn) AS Track_Percent_PerDay
	   FROM 
	   (
		   SELECT
			 DISTINCT (a.Id) AS User_ID,
			 a.ActivityDate AS Activity_Date,
			 a.Total_Minutes_Worn AS Total_Minutes_Worn,
			 COUNT (DISTINCT b.HeartRecord_Minute) AS Heart_Record_Minutes
		   FROM 
			 Daily_Minute_WornPerDay AS a
			 LEFT JOIN `my-first-project-project-51124.Fitabase.Heart_Minute_Reformed` AS b
			 ON a.Id = b.Id
			 AND a.ActivityDate = b.ActivityDate
		   GROUP BY User_ID, Activity_Date, a.Total_Minutes_Worn
	   )   
		GROUP BY User_ID, Activity_Date, Track_Percent_Perday
	 ) 
	 GROUP BY User_ID
	 ORDER BY User_ID
	 ;
	
</code></pre>
					</div>
				  </section>	   

			<!-- Share & Act -->
			<section id="share_act" class="two">
				<div class="container">
				   <header>
					<h2>Share & Act</h2>
				   </header>
				   <p>Share & Act dummy</p>
				   <iframe style="width: 85%; height: 450px;" src="Wearable_Fitness_Tracker_May2023.pdf" frameborder="0"></iframe>
				</div>
			  </section>	
		</div>
		<!-- Footer -->
			<div id="footer">

				<!-- Copyright -->
					<ul class="copyright">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>